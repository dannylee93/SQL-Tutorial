# 관계형 데이터베이스

수 많은 사용자들에게 효율적인 데이터 관리와 예상치 못한 사건으로 인한 데이터 손상을 막고, 필요하다면 데이터 복구까지 할 수 있는 이런 요구사항을 만족시켜주는 것이 DBMS(Database Management System) 라고 한다.



#### 관계형 데이터베이스(Relational Database)

만약 하나의 파일을 여러 지사에서 복사해 나눠가진 다음, 변경작업을 하면 이 여러 개의 변경된 파일은 결국 데이터의 불 일치성이 생긴다. 그래서 관계형 데이터베이스는 **정규화를 통해 합리적인 테이블 모델링으로 이상현상을 제거하고 많은 사용자들이 동시에 데이터를 공유 또는 조작할 수** 있게 구현 해준다.



#### SQL(Structured Query Language)

관계형 데이터베이스에서 데이터 정의, 데이터 조작, 데이터 제어를 하기 위해 사용하는 언어이다. SQL 문장은 단순 스크립트가 아니라 이름에도 포함되어 있듯이, 일반적인 개발 언어처럼 독립된 하나의 개발 언어이다.

![](http://www.dbguide.net/publishing/img/knowledge/SQL_148.jpg)

> 공식적으로는 4가지 그룹으로 나눌 것을 권고한다.



#### TABLE

만약 아래 이미지의 왼쪽 처럼 정리되지 않은 자료가 있다면 어떨까?

![](http://www.dbguide.net/publishing/img/knowledge/SQL_149.jpg)

나도 알아보기 힘들고, 다른사람도 알아보기 힘들 것이다. 하지만 오른쪽은 한눈에 보기 쉬워 다른 사람에게도 도움이 될 수 있다. 

*여기서 테이블이란*

데이터들은 관계형 데이터베이스의 기본 단위인 테이블 형태로 저장된다. 테이블은 어느 특정 주제와 목적으로 만들어지는 일종의 집합이다. 

![](http://www.dbguide.net/publishing/img/knowledge/SQL_151.jpg)

위에 표로 얘기하자면, 맨위에 [선수, 팀, 연고지,,,등]이 각각의 칼럼이고, 해당 테이블은 반드시 하나의 칼럼을 가져야 한다.

![](http://www.dbguide.net/publishing/img/knowledge/SQL_152.jpg)

이청용 선수의 정보는 위와 같이 8개의 칼럼을 가지는 하나의 행으로 데이터화 되어 테이블에 저장된 것이다.



![](http://www.dbguide.net/publishing/img/knowledge/SQL_154.jpg)

![](http://www.dbguide.net/publishing/img/knowledge/SQL_155.jpg)

> 위의 테이블 구조에 대한 용어 설명이다.



그런데 여기서 **중요**한게 있다.

모든 데이터를 하나의 테이블로 저장하지 않는다는 것이다. 

![](http://www.dbguide.net/publishing/img/knowledge/SQL_156.jpg)

위와 같은 과정으로 테이블을 나누는 것을 정규화라고 한다. 이상현상 방지를 위한 중요한 프로세스중 하나이다.

여기서 눈여겨 볼 점은 구단테이블의 기본키가 선수테이블의 외부키로 들어와있다는 것이다. 

외부키(Foreign Key)는 `구단코드`와 같이 다른 테이블의 기본 키로 사용되면서 테이블과의 관계를 연결하는 역할을 하는 칼럼을 말한다.



#### ERD(Entity Relationship Diagram)

이거는 말하자면, 테이블끼리 관계를 표시한것이다. 다이어그램으로 그려져있어 한눈에 보기 쉽다(고 말한다.)

ERD의 구성 요소는 엔터티(Entity), 관계(Relationship), 속성(Attribute) 3가지이며 현실 세계의 데이터는 이 3가지 구성 요소로 모두 표현이 가능하다.

![](http://www.dbguide.net/publishing/img/knowledge/SQL_158.jpg)





## DDL (Data Definition Language)

> 데이터 정의어 라고 하며, 데이터의 구조를 만드는데 사용하는 언어들의 집합이다.



#### 데이터의 유형

데이터베이스의 테이블 안에 특정 자료를 입력할 때, 그 공간에 넣는 자료의 유형이다. 그러니까, 특정 칼럼을 만드려고 할 때 이 칼럼이 받아들일 자료의 유형을 규정하는 것이다. 규정된 유형이 아닌 이 외의 유형의 데이터가 들어오면 에러가 발생된다.

유형과 함께 `크기(size)` 도 지정하는데 이것도 정말 중요하다.

![](http://www.dbguide.net/publishing/img/knowledge/SQL_162.jpg)

> 데이터의 유형 정리 이미지 이다.

문자열 유형을 테이블 안에 넣고 싶다면, CHAR 유형과 VARCHAR 유형(위 이미지에서 1,2번 행) 중 선택해야 하는 문제가 있다. `저장영역`과 문자열의 `비교방법`으로 구분할 수 있다.

**VARCHAR 유형**은 가변 길이이므로 필요한 영역은 실제 데이터 크기이며, 정의된 길이와 실제 데이터의 길이에 차이가 있는 칼럼에 적합하다.(팀명, 집 주소 등) VARCHAR에서 `(s)` 는 들어올 수 있는 데이터의 한계값을 의미한다.

비교 방법의 차이로, CHAR는 문자열을 비교할 때 `공백` 을 채워서 비교한다. 그에 반해 VARCHAR 유형에서는 맨 처음부터 한 문자씩 비교하고 공백도 하나의 문자로 취급하므로 끝의 **공백이 다르면 다른 문자로 판단**한다.

```sql
# CHAR 유형
'AA' = 'AA '
============================================================================
# VARCHAR 유형
'AA' != 'AA '
```



#### CREATE TABLE

테이블은 일정한 형식에 의해 생성된다. 테이블을 생성하려면 여기에 입력 될 **데이터를 정의**하고, **데이터 유형**을 정해야한다.



1. 칼럼 정의

   *첫 번째로*, 모든 데이터를 고유하게 식별하게 해줄 수 있으면서, 반드시 값이 있는 단일 칼럼/조합 중에서 하나를 선정해서 **기본키(PK)로 지정**한다.(예: 학번, 선수ID 등)

   *그 다음으로*, 테이블과 테이블관의 관계를 정의하고 이상현상이 발생하지 않게 모델링과 정규화 과정을 거친다.

2. 테이블 CREATE 하기

   ```sql
   CREATE　TABLE　테이블이름 ( 칼럼명1 DATATYPE [DEFAULT 형식], 
                  			  칼럼명2 DATATYPE [DEFAULT 형식], 
                             칼럼명2 DATATYPE [DEFAULT 형식]) ;
   ```

   - 생성 시 주의할 규칙

     - 테이블 명은 객체를 의미할 수 있는 적절한 이름 사용(가능한 단수형)

     - 테이블 끼리의 이름은 중복되지 않게

     - 한 테이블 내에서 칼럼명 또한 중복되지 않게(다른 테이블 내 칼럼명과는 중복 가능)

     - 위 코드블럭 처럼 `테이블 이름`을 지정하고 각 칼럼들은 괄호 `"( )"` 로 묶어 지정

     -  `A-Z`, `a-z`, `0-9`, `_`, `$`, `#` 문자만 허용된다.

       ![](http://www.dbguide.net/publishing/img/knowledge/SQL_165.jpg)

       > 테이블 명의 잘못된 사례

3. 제약조건(CONSTRAINT)

   사용자가 원하는 조건의 데이터만 유지하기 위한 보편적인 방법으로 테이블의 특정 칼럼에 설정하는 제약. 

   이건 반드시 기술할 필요는 없지만, 이후에 *ALTER TABLE을 이용해서 추가, 수정하는 경우 데이터가 이미 입력된 경우라면* 처리 과정이 쉽지 않으므로 초기 테이블 생성 시점부터 적합한 제약 조건에 대한 충분한 검토가 있어야 한다.

   ![](http://www.dbguide.net/publishing/img/knowledge/SQL_166.jpg)

   - NULL

     NULL(ASCII 코드 00번)은 `공백`(BLANK, ASCII 코드 32번)이나 `숫자 0`(ZERO, ASCII 48)과는 전혀 다른 값이며,  **‘아직 정의되지 않은 미지의 값’**이거나 **‘현재 데이터를 입력하지 못하는 경우’**를 의미한다.

   - DEFAULT

     **기본값**이라고 하는DEFAULT는 사전에 설정할 수 있다. 데이터를 입력할 때 어떤 값을 명시해두지 않으면 `NULL` 이 입력되고, 디폴트 값을 정의했으면 `NULL`값 대신 정의된 기본값이 자동 입력 되어있다.